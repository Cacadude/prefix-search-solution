# –†–µ—à–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ —Ç–æ–≤–∞—Ä–æ–≤

[![Coverage](https://img.shields.io/badge/coverage-96.67%25-brightgreen)]()
[![Latency](https://img.shields.io/badge/latency-67.51ms-success)]()
[![Elasticsearch](https://img.shields.io/badge/elasticsearch-8.11.0-blue)]()
[![Python](https://img.shields.io/badge/python-3.11-blue)]()

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É —Ç–æ–≤–∞—Ä–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ (1-3 —Å–∏–º–≤–æ–ª–∞)
- ‚úÖ –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- ‚úÖ –ß–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–≤–µ—Å, –æ–±—ä–µ–º)
- ‚úÖ –ó–∞—â–∏—Ç—ã –æ—Ç –º—É—Å–æ—Ä–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ + –ª–∞—Ç–∏–Ω–∏—Ü–∞)
- ‚úÖ –†–∞–∑–±–∏—Ç—ã—Ö —Å–ª–æ–≤ (–ø—Ä–æ–±–µ–ª—ã –º–µ–∂–¥—É –±—É–∫–≤–∞–º–∏)
- ‚úÖ –ê–Ω–≥–ª–∏–π—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –±—Ä–µ–Ω–¥–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**: –ü–æ–∫—Ä—ã—Ç–∏–µ **96.67%** (58 –∏–∑ 60 –∑–∞–ø—Ä–æ—Å–æ–≤) –ø—Ä–∏ –∑–∞–¥–µ—Ä–∂–∫–µ **67.51 –º—Å** ‚úÖ

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Elasticsearch 8.11** - –ø–æ–∏—Å–∫–æ–≤—ã–π –¥–≤–∏–∂–æ–∫
- **Flask API** - REST API –¥–ª—è –ø–æ–∏—Å–∫–∞
- **Python 3.11** - —è–∑—ã–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
prefix-search-solution/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ load_catalog.py    # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Elasticsearch
‚îÇ   ‚îî‚îÄ‚îÄ search_api.py      # API —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–∏—Å–∫–∞
‚îú‚îÄ‚îÄ tools/
‚îÇ   ‚îî‚îÄ‚îÄ evaluate.py        # –°–∫—Ä–∏–ø—Ç –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ catalog_products.xml    # –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ prefix_queries.csv      # –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
‚îú‚îÄ‚îÄ reports/               # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏
‚îú‚îÄ‚îÄ docker-compose.yml     # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile            # –û–±—Ä–∞–∑ –¥–ª—è API —Å–µ—Ä–≤–∏—Å–∞
‚îî‚îÄ‚îÄ requirements.txt      # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

> üìñ **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∑–∞ 3 –∫–æ–º–∞–Ω–¥—ã**: –°–º. [QUICKSTART.md](QUICKSTART.md)

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/Cacadude/prefix-search-solution.git
cd prefix-search-solution
```

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–≤–∫–ª—é—á–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö)
docker compose up -d

# –û–∂–∏–¥–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–æ–∫–æ–ª–æ 30-60 —Å–µ–∫—É–Ω–¥)
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API
curl http://localhost:5000/health

# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
curl "http://localhost:5000/search?query=–º–∞—Å–ª–æ&top_k=3"
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å `init_data` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ 30-60 —Å–µ–∫—É–Ω–¥.

**–í–∞–∂–Ω–æ**: –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `docker compose up -d` –ø–æ–¥–æ–∂–¥–∏—Ç–µ 30-60 —Å–µ–∫—É–Ω–¥, –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –≤ Elasticsearch. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `curl http://localhost:5000/health`.

### 3. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- Elasticsearch 8.x (–∑–∞–ø—É—â–µ–Ω–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 9200)

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ Elasticsearch (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω)
# docker run -d -p 9200:9200 -e "discovery.type=single-node" -e "xpack.security.enabled=false" docker.elastic.co/elasticsearch/elasticsearch:8.11.0

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
python src/load_catalog.py --catalog data/catalog_products.xml

# –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–∏—Å–∞
python src/search_api.py
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### API Endpoints

#### –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
```bash
GET /search?query=–º–∞—Å–ª–æ&top_k=5
POST /search
{
  "query": "–º–∞—Å–ª–æ —Ä–∞—Å—Ç 10–ª",
  "top_k": 5
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl "http://localhost:5000/search?query=–º–∞—Å–ª–æ&top_k=3"
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "query": "–º–∞—Å–ª–æ",
  "results": [
    {
      "id": "P0008",
      "name": "–ú–∞—Å–ª–æ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–æ–µ –Ω–µ—Ä–∞—Ñ–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ ¬´Golden Field¬ª 500–º–ª",
      "category": "–ë–∞–∫–∞–ª–µ—è",
      "brand": "Golden Field",
      "price": 1574.36,
      "weight": "500",
      "weight_unit": "ml",
      "score": 12.5
    }
  ],
  "total": 3,
  "latency_ms": 45.2
}
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
```bash
GET /health
```

### –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

```bash
# –ó–∞–ø—É—Å–∫ –æ—Ü–µ–Ω–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
python tools/evaluate.py \
    --queries data/prefix_queries.csv \
    --output reports/evaluation_results.csv \
    --base-url http://localhost:5000

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
# - reports/evaluation_results.csv - –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
# - reports/metrics.json - –º–µ—Ç—Ä–∏–∫–∏
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫:**
```bash
# Windows (PowerShell)
Get-Content reports/metrics.json | ConvertFrom-Json | ConvertTo-Json

# Linux/Mac
cat reports/metrics.json

# –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ –ª—é–±–æ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (CSV):**

**Windows:**
```powershell
# –û—Ç–∫—Ä—ã—Ç—å CSV –≤ Excel/Notepad++ —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8
# –ò–ª–∏ —á–µ—Ä–µ–∑ PowerShell:
Import-Csv reports/evaluation_results.csv -Encoding UTF8 | Format-Table

# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ –±–ª–æ–∫–Ω–æ—Ç–µ (—É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8)
notepad reports/evaluation_results.csv
```

**Linux/Mac:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ cat
cat reports/evaluation_results.csv

# –ò–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π UTF-8
nano reports/evaluation_results.csv
# –∏–ª–∏
code reports/evaluation_results.csv
```

**–í–∞–∂–Ω–æ**: –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ CSV —Ñ–∞–π–ª–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ **UTF-8**, –∏–Ω–∞—á–µ —Ä—É—Å—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –º–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ CSV —Ñ–∞–π–ª–∞:**
- `query` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `result_1`, `result_2`, `result_3` - —Ç–æ–ø-3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (ID —Ç–æ–≤–∞—Ä–æ–≤)
- `score_1`, `score_2`, `score_3` - —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `category_1`, `category_2`, `category_3` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã

- **edge_ngram** (1-15 —Å–∏–º–≤–æ–ª–æ–≤) –¥–ª—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **layout_analyzer** –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- **russian_stemmer** –¥–ª—è –º–æ—Ä—Ñ–æ–ª–æ–≥–∏–∏ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- –ú—É–ª—å—Ç–∏–ø–æ–ª–µ–≤–æ–π –ø–æ–∏—Å–∫ —Å –±—É—Å—Ç–∞–º–∏:
  - name^3 (–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞)
  - brand^2 (–±—Ä–µ–Ω–¥)
  - category^1.5 (–∫–∞—Ç–µ–≥–æ—Ä–∏—è)
  - keywords^2 (–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞)

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**: —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤, –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∏—Å–µ–ª**: —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≤–µ—Å–∞/–æ–±—ä–µ–º–∞ (10–ª, 5–∫–≥, 3 —à—Ç)
- **–¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ (xfq ‚Üí —á–∞–π)
- **–ü—Ä–µ—Ñ–∏–∫—Å–Ω—ã–π –ø–æ–∏—Å–∫**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (1-2 —Å–∏–º–≤–æ–ª–∞)

### 3. –ó–∞—â–∏—Ç–∞ –æ—Ç –º—É—Å–æ—Ä–∞

- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ (score > 0.1)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
- –î–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ –≤–∞–∂–Ω—ã—Ö –ø–æ–ª–µ–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —á–µ—Ä–µ–∑ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

### 4. –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ

- Multi-match –∑–∞–ø—Ä–æ—Å —Å –±—É—Å—Ç–∞–º–∏ –ø–æ –ø–æ–ª—è–º
- –£—á–µ—Ç —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–µ—Å—É/–æ–±—ä–µ–º—É)
- Fuzzy matching –¥–ª—è –æ–ø–µ—á–∞—Ç–æ–∫ (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- Match phrase prefix –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤

## –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- **–ü–æ–∫—Ä—ã—Ç–∏–µ (Coverage)**: **96.67%** (58 –∏–∑ 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- **–°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ (Latency)**: **67.51 –º—Å**
- **–£—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**: 60/60 (100%)
- **–î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**: —Ç–æ–ø-3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `reports/evaluation_results.csv`

**–¶–µ–ª–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å**: ‚â•70% –ø–æ–∫—Ä—ã—Ç–∏–µ –±–µ–∑ —Ä—É—á–Ω—ã—Ö whitelist-–ø—Ä–∞–≤–∏–ª ‚úÖ **–ü–†–ï–í–´–®–ï–ù**

### –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**1. –ó–∞–ø—É—Å–∫ –æ—Ü–µ–Ω–∫–∏:**
```bash
python tools/evaluate.py \
    --queries data/prefix_queries.csv \
    --output reports/evaluation_results.csv \
    --base-url http://localhost:5000
```

**2. –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫ (JSON):**
```bash
# Windows PowerShell
Get-Content reports/metrics.json

# Linux/Mac
cat reports/metrics.json
```

**3. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (CSV –≤ UTF-8):**

**Windows:**
```powershell
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ PowerShell (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8)
Import-Csv reports/evaluation_results.csv -Encoding UTF8 | Format-Table

# –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–∫—Ä—ã—Ç—å –≤ Excel/Notepad++ (–≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É UTF-8 –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏)
# Excel: –î–∞–Ω–Ω—ã–µ ‚Üí –ò–∑ —Ç–µ–∫—Å—Ç–∞ ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª ‚Üí –ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8
# Notepad++: –ö–æ–¥–∏—Ä–æ–≤–∫–∞ ‚Üí –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ UTF-8

# –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ –±–ª–æ–∫–Ω–æ—Ç (—É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ UTF-8)
notepad reports/evaluation_results.csv
```

**Linux/Mac:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ cat (UTF-8 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
cat reports/evaluation_results.csv

# –ò–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
nano reports/evaluation_results.csv
code reports/evaluation_results.csv  # VS Code
```

**–í–∞–∂–Ω–æ**: CSV —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ **UTF-8**. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤ Excel –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞, –∏–Ω–∞—á–µ —Ä—É—Å—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –º–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `√ê¬º√ê¬∞√ë\x81√ê¬ª√ê¬æ` –≤–º–µ—Å—Ç–æ `–º–∞—Å–ª–æ`).

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ CSV —Ñ–∞–π–ª–∞:**
- `query` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `result_1`, `result_2`, `result_3` - ID —Ç–æ–≤–∞—Ä–æ–≤ (—Ç–æ–ø-3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)
- `score_1`, `score_2`, `score_3` - —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å (score –æ—Ç Elasticsearch)
- `category_1`, `category_2`, `category_3` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- `name_1`, `name_2`, `name_3` - –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤

### –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø—Ä–æ—Å–æ–≤

–†–µ—à–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
- ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã (1-3 —Å–∏–º–≤–æ–ª–∞): "–º–∞", "pr", "xfq"
- ‚úÖ –†–∞–∑–±–∏—Ç—ã–µ —Å–ª–æ–≤–∞: "–∫–∞—Ä —Ç–æ—Ñ–µ–ª—å", "–≥—Ä–µ—á –Ω–µ", "–∫—Ä—É–ø –≥—Ä–µ—á"
- ‚úÖ –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã: "adapter usb c", "power bank 20", "prosecco ro"
- ‚úÖ –ë—Ä–µ–Ω–¥—ã: "teos", "—Ö–æ–ª—Å", "san pelle"
- ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏: "lay chips", "diap night", "cat adult"
- ‚úÖ –ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: "–º–∞—Å–ª–æ —Ä–∞—Å—Ç 10–ª", "–ø–∞–º–ø–µ—Ä—Å—ã 3", "–º–µ—à–∫–∏ 120–ª"
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏: "xfq" ‚Üí "—á–∞–π"

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏–∑ prefix_queries.csv

–†–µ—à–µ–Ω–∏–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

1. **Mobile Shopper (Store A/D)**: –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã ("–º–∞", "–º–∞—Å–ª–æ —Å–ª")
2. **Premium Buyer (Store F)**: –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è ("prosecco rose", "riesling mos")
3. **B2B Buyer (Store C)**: —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ ("–º–∞—Å–ª–æ —Ä–∞—Å—Ç 10–ª", "cheddar 5kg")
4. **General Retail (Store E)**: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ ("xfq" ‚Üí "—á–∞–π")

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã Elasticsearch

1. **prefix_analyzer**: 
   - Edge n-gram (1-15 —Å–∏–º–≤–æ–ª–æ–≤) –¥–ª—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
   - Russian stemmer –¥–ª—è –º–æ—Ä—Ñ–æ–ª–æ–≥–∏–∏
   - Russian stop words —Ñ–∏–ª—å—Ç—Ä
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –ø–æ–ª—è–º: name, category, brand, keywords, description

2. **search_analyzer**:
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä
   - Russian stemmer
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ (–±–µ–∑ edge_ngram)

3. **english_analyzer**:
   - Edge n-gram –¥–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤
   - –ë–µ–∑ —Å—Ç–µ–º–º–∏–Ω–≥–∞ (–≤–∞–∂–Ω–æ –¥–ª—è –±—Ä–µ–Ω–¥–æ–≤)
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –ø–æ–ª—é brand.english

4. **layout_analyzer**:
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (QWERTY ‚Üî –ô–¶–£–ö–ï–ù)
   - Keyword —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –º–∞–ø–ø–∏–Ω–≥–∞
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –ø–æ–ª—è–º: name.layout, brand.layout, search_text.layout

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞

–†–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤:

1. **Multi-match (best_fields)**: –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º —Å –±—É—Å—Ç–∞–º–∏
2. **Multi-match (bool_prefix)**: –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–π –ø–æ–∏—Å–∫ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è
3. **Prefix queries**: —Ç–æ—á–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ keyword –ø–æ–ª—è–º
4. **Wildcard queries**: –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (1-2 —Å–∏–º–≤–æ–ª–∞)
5. **Match phrase prefix**: –¥–ª—è —Ñ—Ä–∞–∑–æ–≤—ã—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤
6. **Match queries**: –ø–æ–∏—Å–∫ –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–ª–æ–≤–∞–º –¥–ª—è –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**: —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤, –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏**: –æ–±—Ä–∞–±–æ—Ç–∫–∞ URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤**: –¥–ª—è —Ä–∞–∑–±–∏—Ç—ã—Ö —Å–ª–æ–≤ ("–∫–∞—Ä —Ç–æ—Ñ–µ–ª—å" ‚Üí "–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å")
4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏**: —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (1-3 —Å–∏–º–≤–æ–ª–∞)
5. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∏—Å–µ–ª**: —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≤–µ—Å–∞/–æ–±—ä–µ–º–∞ —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è

### –ó–∞—â–∏—Ç–∞ –æ—Ç –º—É—Å–æ—Ä–∞

–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

1. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏**: —É–±—Ä–∞–Ω –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å–ª–æ–≤**: —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Å–ª–æ–≤–æ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤**: –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø—Ä–µ—Ñ–∏–∫—Å—ã –≤–∞–∂–Ω—ã—Ö –ø–æ–ª–µ–π
4. **Fallback –º–µ—Ö–∞–Ω–∏–∑–º**: –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É–±—Ä–∞–ª–∞ –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ø–æ–≤—ã–µ –æ—Ç Elasticsearch

## Reflection

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

1. **–û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã (1 —Å–∏–º–≤–æ–ª)**: 
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –º–æ–≥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - **–†–µ—à–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–ª–µ–Ω wildcard –ø–æ–∏—Å–∫ –ø–æ keyword –ø–æ–ª—è–º —Å –≤—ã—Å–æ–∫–∏–º –±—É—Å—Ç–æ–º –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

2. **–°–º–µ—à–∞–Ω–Ω–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞**: 
   - **–ü—Ä–æ–±–ª–µ–º–∞**: —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
   - **–†–µ—à–µ–Ω–∏–µ**: layout_analyzer –≤ Elasticsearch + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ API —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

3. **–ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã**: 
   - **–ü—Ä–æ–±–ª–µ–º–∞**: —Ä—É—Å—Å–∫–∏–π —Å—Ç–µ–º–º–µ—Ä –ø–æ—Ä—Ç–∏–ª –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–ª–æ–≤–∞
   - **–†–µ—à–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–ª–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π english_analyzer –¥–ª—è –±—Ä–µ–Ω–¥–æ–≤ –±–µ–∑ —Å—Ç–µ–º–º–∏–Ω–≥–∞

4. **–†–∞–∑–±–∏—Ç—ã–µ —Å–ª–æ–≤–∞**: 
   - **–ü—Ä–æ–±–ª–µ–º–∞**: "–∫–∞—Ä —Ç–æ—Ñ–µ–ª—å" –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª "–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å"
   - **–†–µ—à–µ–Ω–∏–µ**: —Ñ—É–Ω–∫—Ü–∏—è remove_spaces_for_prefix —É–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–±–µ–ª—ã –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

5. **–ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: 
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª–æ 13.33%
   - **–†–µ—à–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞ (bool_prefix, wildcard, prefix) –∏ –æ—Å–ª–∞–±–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

### –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

1. **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å embeddings)
2. **–û–±—É—á–µ–Ω–∏–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ML-–º–æ–¥–µ–ª–∏ (LTR - Learning to Rank) –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (Redis) –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏
4. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (Prometheus/Grafana)
6. **–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ**: –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ –∑–∞–ø—Ä–æ—Å–∞ (prefix suggestions)
7. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—á–∞—Ç–æ–∫**: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è spellchecker –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—á–∞—Ç–æ–∫
8. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**: —É—á–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞ –∏ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ï—Å–ª–∏ –±—ã —ç—Ç–æ —à–ª–æ –≤ –ø—Ä–æ–¥

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Client    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Load        ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   API       ‚îÇ
‚îÇ  (Mobile)   ‚îÇ     ‚îÇ  Balancer    ‚îÇ     ‚îÇ  Service    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                  ‚îÇ
                                                  ‚ñº
                                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                         ‚îÇ  Elasticsearch  ‚îÇ
                                         ‚îÇ    Cluster      ‚îÇ
                                         ‚îÇ  (3+ nodes)     ‚îÇ
                                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                  ‚îÇ
                                                  ‚ñº
                                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                         ‚îÇ   Monitoring    ‚îÇ
                                         ‚îÇ  (Prometheus/   ‚îÇ
                                         ‚îÇ   Grafana)      ‚îÇ
                                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

#### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

1. **–ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏**:
   - –ü–æ–∫—Ä—ã—Ç–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (target: ‚â•70%, —Ç–µ–∫—É—â–µ–µ: 96.67%)
   - –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ (target: <100–º—Å, —Ç–µ–∫—É—â–µ–µ: 67.51–º—Å)
   - –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –¢–æ–ø-10 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - –¢–æ–ø-10 –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

2. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏**:
   - CPU/Memory –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Elasticsearch
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É (RPS)
   - –†–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞
   - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (p50, p95, p99)
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ (4xx, 5xx)

3. **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞**:
   - Precision@3, Precision@5
   - Click-through rate (CTR) –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
   - Conversion rate (–ø–æ–∫—É–ø–∫–∏ –ø–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞)
   - Bounce rate (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É—à–ª–∏ –±–µ–∑ –∫–ª–∏–∫–∞)

#### –ê–ª–µ—Ä—Ç—ã

- üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ**:
  - –ü–æ–∫—Ä—ã—Ç–∏–µ —É–ø–∞–ª–æ –Ω–∏–∂–µ 70%
  - –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ > 500–º—Å
  - Elasticsearch –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  - –û—à–∏–±–∫–∏ > 1% –∑–∞–ø—Ä–æ—Å–æ–≤

- üü° **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**:
  - –ü–æ–∫—Ä—ã—Ç–∏–µ —É–ø–∞–ª–æ –Ω–∏–∂–µ 80%
  - –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ > 200–º—Å
  - CPU Elasticsearch > 80%
  - –†–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞ –≤—ã—Ä–æ—Å –Ω–∞ 20%

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—á–µ—Å—Ç–≤–∞)
- –ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è)
- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (>100–º—Å)
- –û—à–∏–±–∫–∏ —Å –ø–æ–ª–Ω—ã–º —Å—Ç–µ–∫—Ç—Ä–µ–π—Å–æ–º
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

#### Elasticsearch

- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∫–ª–∞—Å—Ç–µ—Ä –∏–∑ 3+ —É–∑–ª–æ–≤
- **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è**: –º–∏–Ω–∏–º—É–º 1 —Ä–µ–ø–ª–∏–∫–∞ –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
- **–®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –Ω–∞ —à–∞—Ä–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º/–±—Ä–µ–Ω–¥–∞–º
- **Hot/Warm –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –≥–æ—Ä—è—á–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ SSD, —Ö–æ–ª–æ–¥–Ω—ã–µ –Ω–∞ HDD
- **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ snapshots –≤ S3

#### API Service

- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –∑–∞ load balancer
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: Redis –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (TTL: 1 —á–∞—Å)
- **Rate limiting**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/IP
- **Circuit breaker**: –∑–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤

#### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

- **Kubernetes**: –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **Service Mesh**: Istio –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–æ–º
- **CDN**: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- **Database**: –æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: API –∫–ª—é—á–∏ –∏–ª–∏ OAuth2
2. **Rate limiting**: –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –∑–∞—â–∏—Ç–∞ –æ—Ç injection –∞—Ç–∞–∫
4. **HTTPS**: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞
5. **–ê—É–¥–∏—Ç –ª–æ–≥–∏**: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

### –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

#### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-3 –º–µ—Å—è—Ü–∞)

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: Redis –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2. **–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ**: –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ (prefix suggestions)
3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—á–∞—Ç–æ–∫**: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è spellchecker (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ø–Ω–¥–µ–∫—Å.–°–ø–µ–ª–ª–µ—Ä)
4. **–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤**: –±—É—Å—Ç –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–¥–∞–∂
5. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

#### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (3-6 –º–µ—Å—è—Ü–µ–≤)

1. **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å embeddings (–Ω–∞–ø—Ä–∏–º–µ—Ä, sentence-transformers)
2. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**: —É—á–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞ –∏ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è**: —É—á–µ—Ç –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
4. **–û–±—É—á–µ–Ω–∏–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è**: ML-–º–æ–¥–µ–ª–∏ (LTR - Learning to Rank)
5. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞

#### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (6+ –º–µ—Å—è—Ü–µ–≤)

1. **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫**: –∫–æ–º–±–∏–Ω–∞—Ü–∏—è keyword –∏ vector search
2. **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫**: –ø–æ–∏—Å–∫ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤
3. **–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫**: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∏—Å–∫–∞
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ**: —Å–∞–º–æ–æ–±—É—á–∞—é—â–∞—è—Å—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ feedback

### –°—Å—ã–ª–∫–∏ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

- [Elasticsearch: Prefix Queries](https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-prefix-query.html)
- [Learning to Rank for Information Retrieval](https://www.microsoft.com/en-us/research/publication/learning-to-rank-for-information-retrieval/)
- [Semantic Search with Vector Embeddings](https://www.elastic.co/blog/semantic-search-with-vector-embeddings)
- [Prefix Search Best Practices](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-as-you-type.html)

## –õ–∏—Ü–µ–Ω–∑–∏—è

–†–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É.

